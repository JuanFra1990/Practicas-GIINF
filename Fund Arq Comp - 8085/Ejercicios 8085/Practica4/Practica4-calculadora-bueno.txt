;LIMPIAR REGISTROS
MVI A,00
OUT 00
OUT 01
OUT 02
OUT 03
OUT 04
MOV B,A
MOV C,A
MOV D,A
MOV E,A
MOV H,A
MOV L,A
;SUMA Y RESTA CON UN NUMERO
OPERANDOS: LDA DDD0
MOV B,A
LDA DDD1
MOV C,A
OPERACION: LDA DDD2
CPI 01
JZ SUMA
CPI 02
JZ RESTA
CPI 04
JZ MULTIPLICACION
CPI 08
JZ DIVISION
JNZ ERROR

SUMA: MOV A,B
ADD C
DAA
MOV E,A
JMP RESULTADO

RESTA:MOV A,B
SUB C
MOV E,A
CALL COMPARACION
JMP CIFRA

AJUSTEDECIMAL:SUI 06
MOV E,A
RET

AJUSTEDECIMALD:SUI 06
MOV B,A
RET

MULTIPLICACION:MOV A,C
CPI 00
JZ CIFRA
MOV A,C
SUI 01
MOV C,A
CPI 00
JZ RESULTADOM
MOV E,B
BUCLE: MOV A,E
ADD B
DAA
MOV E,A
MOV A,C
SUI 01
MOV C,A
CPI 00
MOV A,E
JZ RESULTADO
JNZ BUCLE

;DIVISION HEXADECIMAL
DIVISION:MOV H,C
MOV A,C
CPI 00
JZ ERROR
MOV A,C
SUI 01
CPI 00
JZ RESULTADOM
MVI E,00
BUCLED: MOV A,E
ADI 01
MOV E,A
MOV A,B
SUB C
MOV B,A
JC RESULTADOD
JNC BUCLED

COMPARACION: MOV A,E
CPI 0A
CZ AJUSTEDECIMAL
CPI 0B
CZ AJUSTEDECIMAL
CPI 0C
CZ AJUSTEDECIMAL
CPI 0D
CZ AJUSTEDECIMAL
CPI 0E
CZ AJUSTEDECIMAL
CPI 0F
CZ AJUSTEDECIMAL
RET

RESULTADOM: MOV E,B
MOV A,B
JMP RESULTADO

RESULTADOD: MOV A,E
SUI 02
MOV E,A
SUI 10
JZ DIEZ; SI EL RESULTADO ES DE DIEZ
JC CIFRA ;SI EL RESULTADO ES DE UNA CIFRA
MOV A,E
JNC AJUSTE; SI EL RESULTADO ES MAYOR DE DIEZ

RESULTADO: SUI 10
CPI 00
JZ DIEZ; SI EL RESULTADO ES DE DIEZ
JC CIFRA ;SI EL RESULTADO ES DE UNA CIFRA
MOV A,E
JNC AJUSTE; SI EL RESULTADO ES MAYOR DE DIEZ

AJUSTE:CPI 10
JC CONTINUA
MOV A,E
SUI 10
CPI 10
JNC AJUSTE
CONTINUA:MOV E,A
SUI 10
MOV A,E
MOV A,D
ADI 01
MOV D,A
CALL COMPROBACION
CALL DESPLAZAR
MOV A,E
CALL COMPROBACION
HLT

CIFRA: CALL CERO
CALL DESPLAZAR
MOV A,E
CALL COMPROBACION
HLT

DIEZ: MOV E,A
CALL UNO
CALL DESPLAZAR
MOV A,E
CALL COMPROBACION
HLT

COMPROBACION: CPI 00
JZ CERO
CPI 01
JZ UNO
CPI 02
JZ DOS
CPI 03
JZ TRES
CPI 04
JZ CUATRO
CPI 05
JZ CINCO
CPI 06
JZ SEIS
CPI 07
JZ SIETE
CPI 08
JZ OCHO
CPI 09
JZ NUEVE
JMP ERROR
HLT


DESPLAZAR: MVI B,00
MVI C,04
DESPLAZAMIENTO:IN 00
RLC
OUT 00
IN 01
RLC
OUT 01
IN 02
RLC
OUT 02
IN 03
RLC
OUT 03
IN 04
RLC
OUT 04
DCR C
MOV A, B
CMP C
JNZ DESPLAZAMIENTO

RET

NUEVE:MVI B 07
IN 00
XRA B
OUT 00
MVI B 05
IN 01
XRA B
OUT 01
MVI B 07
IN 02
XRA B
OUT 02
MVI B 01
IN 03
XRA B
OUT 03
MVI B 07
IN 04
XRA B
OUT 04
RET

OCHO:MVI B 07
IN 00
XRA B
OUT 00
MVI B 05
IN 01
XRA B
OUT 01
MVI B 07
IN 02
XRA B
OUT 02
MVI B 05
IN 03
XRA B
OUT 03
MVI B 07
IN 04
XRA B
OUT 04
RET

SIETE:MVI B 07
IN 00
XRA B
OUT 00
MVI B 05
IN 01
XRA B
OUT 01
MVI B 05
IN 02
XRA B
OUT 02
MVI B 01
IN 03
XRA B
OUT 03
MVI B 01
IN 04
XRA B
OUT 04
RET

SEIS:MVI B 07
IN 00
XRA B
OUT 00
MVI B 04
IN 01
XRA B
OUT 01
MVI B 07
IN 02
XRA B
OUT 02
MVI B 05
IN 03
XRA B
DAA
OUT 03
MVI B 07
IN 04
ORA B
DAA
OUT 04
ORA B
RET

CINCO:MVI B 07
IN 00
XRA B
OUT 00
MVI B 04
IN 01
XRA B
OUT 01
MVI B 07
IN 02
XRA B
OUT 02
MVI B 01
IN 03
XRA B
OUT 03
MVI B 07
IN 04
XRA B
OUT 04
RET

CUATRO:MVI B 05
IN 00
XRA B
OUT 00
MVI B 05
IN 01
XRA B
OUT 01
MVI B 07
IN 02
XRA B
OUT 02
MVI B 01
IN 03
XRA B
OUT 03
MVI B 01
IN 04
XRA B
OUT 04
RET

TRES:MVI B 07
IN 00
XRA B
OUT 00
MVI B 01
IN 01
XRA B
OUT 01
MVI B 07
IN 02
XRA B
OUT 02
MVI B 01
IN 03
XRA B
OUT 03
MVI B 07
IN 04
XRA B
OUT 04
RET

DOS:MVI B 07
IN 00
XRA B
OUT 00
MVI B 01
IN 01
XRA B
OUT 01
MVI B 07
IN 02
XRA B
OUT 02
MVI B 04
IN 03
XRA B
OUT 03
MVI B 07
IN 04
XRA B
OUT 04
RET

UNO: MVI B 01
IN 00
XRA B
OUT 00
MVI B 01
IN 01
XRA B
OUT 01
MVI B 01
IN 02
XRA B
OUT 02
MVI B 01
IN 03
XRA B
OUT 03
MVI B 01
IN 04
XRA B
OUT 04
RET

CERO:MVI B 07
IN 00
XRA B
OUT 00
MVI B 05
IN 01
XRA B
OUT 01
MVI B 05
IN 02
XRA B
OUT 02
MVI B 05
IN 03
XRA B
OUT 03
MVI B 07
IN 04
XRA B
OUT 04
RET

ERROR: MVI A,0F
OUT 00
OUT 02
OUT 04
MVI A,08
OUT 01
OUT 03
HLT